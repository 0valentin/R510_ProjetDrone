<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DroneBuilder ‚Äì Configurateur</title>
  <link rel="stylesheet" href="/styles.css" />
  <link rel="stylesheet" href="/constructeur.css" />
</head>
<body>
  <header class="header">
    <h1>üöÅ DroneBuilder</h1>
    <nav class="nav">
      <a href="/" class="btn-link">Accueil</a>
      <a href="/constructeur" class="btn-link">Cr√©er un drone</a>
    </nav>
  </header>

  <main class="configurateur container">
    <!-- R√âCAP EN HAUT -->
    <section id="resultConfig">
      <h3>R√©capitulatif</h3>
      <ul id="buildList"></ul>
      <button id="btnValider" type="button">Valider le drone</button>
    </section>

    <h2>Choisir les pi√®ces</h2>

    <!-- Contr√¥les -->
    <section class="controls" style="display:flex;gap:10px;flex-wrap:wrap;">
      <label>
        Cat√©gorie :
        <select id="selectCategory">
          <option value="">-- Choisir une cat√©gorie --</option>
        </select>
      </label>

      <button id="openFilters" type="button">Filtres</button>

      <button id="clearCategory" type="button" title="Ne rien s√©lectionner pour cette cat√©gorie">
        Vider la s√©lection de cette cat√©gorie
      </button>
    </section>

    <!-- Tableau pi√®ces -->
    <section class="table-wrapper" id="partsSection" style="display:none;">
      <table id="partsTable">
        <thead></thead>
        <tbody></tbody>
      </table>
    </section>
  </main>

  <!-- MODAL FILTRES : Specs, Compat + Champs g√©n√©raux -->
  <div id="filtersModal" class="modal hidden" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="filtersTitle">
      <header class="modal-header">
        <h3 id="filtersTitle">Filtres (ex√©cut√©s c√¥t√© serveur)</h3>
        <button class="modal-close" id="closeFilters" aria-label="Fermer">‚úï</button>
      </header>

      <div class="modal-body">
        <div class="filter-grid">
          <!-- Brand -->
          <div>
            <div class="label-legend">Brand</div>
            <div id="brandBox" class="check-grid"></div>
          </div>

          <!-- Price -->
          <div>
            <div class="label-legend">Prix</div>
            <label>Devise
              <select id="priceCurrency"><option value="">(toutes)</option></select>
            </label>
            <div class="range-row">
              <label>Min ‚Ç¨ <input id="priceMin" type="number" step="0.01" /></label>
              <label>Max ‚Ç¨ <input id="priceMax" type="number" step="0.01" /></label>
            </div>
          </div>

          <!-- Warranty -->
          <div>
            <div class="label-legend">Garantie (mois)</div>
            <div class="range-row">
              <label>Min <input id="warrantyMin" type="number" step="1" /></label>
              <label>Max <input id="warrantyMax" type="number" step="1" /></label>
            </div>
          </div>

          <!-- SPECS : plusieurs cl√©s/valeurs -->
          <div>
            <div class="label-legend">Specs</div>
            <div id="specsBox" class="stack"></div>
          </div>

          <!-- COMPAT : plusieurs cl√©s/valeurs -->
          <div>
            <div class="label-legend">Compat</div>
            <div id="compatBox" class="stack"></div>
          </div>

          <!-- ‚úÖ CHAMPS G√âN√âRAUX : tous les autres champs de la cat√©gorie -->
          <div>
            <div class="label-legend">Champs g√©n√©raux</div>
            <div class="range-row">
              <label>Ajouter un champ
                <select id="generalFieldSelect"><option value="">(choisir)</option></select>
              </label>
              <button id="addGeneralField" type="button">Ajouter</button>
            </div>
            <div id="generalBox" class="stack"><!-- sections de filtres ajout√©es dynamiquement --></div>
          </div>
        </div>
      </div>

      <footer class="modal-actions">
        <button id="applyFilters" class="btn-primary" type="button">Appliquer</button>
        <button id="resetFilters" type="button">R√©initialiser</button>
      </footer>
    </div>
  </div>

  <footer>
    <p>¬© 2025 DroneBuilder. Tous droits r√©serv√©s.</p>
  </footer>

  <script src="/constructeur.js"></script>
</body>
</html>
